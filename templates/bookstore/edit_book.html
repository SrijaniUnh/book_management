{% extends 'base.html' %}

{% block title %}Edit Book{% endblock %}

{% block content %}
  <div class="container">
    <h2>Edit Book: {{ book.title }}</h2>
    <form id="editBookForm" method="post" action="{% url 'edit_book' pk=book.title %}">
      {% csrf_token %}
      {{ form.as_p }}
      <button type="button" onclick="confirmEdit()">Save Changes</button>
    </form>
  </div>

  <script>
    function confirmEdit() {
      // Show a confirmation dialog
      var confirmed = confirm("Are you sure you want to save changes?");

      // If user confirms, make an Ajax request to submit the form
      if (confirmed) {
        var form = document.getElementById('editBookForm');
        var formData = new FormData(form);

        var xhr = new XMLHttpRequest();
        xhr.open('POST', form.action, true);
        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
        xhr.onload = function () {
          // Handle the response, e.g., display a success message
          alert('Changes saved successfully!');
        };
        xhr.send(formData);
      }
    }
  </script>
{% endblock %}
